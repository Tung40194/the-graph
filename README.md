## Prerequisites
 - @openzeppelin/subgraphs
 - @graphprotocol/graph-cli



## Instruction

The Graph
1) init subgraph
    graph init --product hosted-service --from-contract <Address>
        + subgraph name: canfoundation/can
        + folder: can

Openzeppelin-subgraph Generator
2) Modify subgbraph-config.json with your contract address and modules it supports

3) CD to subgraph-deployment directory

``` bash shell
npx graph-compiler --config subgbraph-config.json --include node_modules/@openzeppelin/subgraphs/src/datasources --export-schema --export-subgraph
```

4) subgraph-config.json by default redirect generated files to overwrite ones in `can/` folder. Check subgraph-config.json and change `can/` to the name of the folder you input in 1) (or what ever folder contains `schema.graphql` and `subgraph.yaml` files)

5) cd to the folder generated by 1) to deploy subgraph
    npm run codegen
    graph auth --product hosted-service <ACCESS_TOKEN>
    graph deploy --product hosted-service <GITHUB_USER>/<SUBGRAPH NAME>
        <ACCESS_TOKEN>: get this in Hosted Service dashboard
        <GITHUB_USER>/<SUBGRAPH NAME>: currently it's "canfoundation/can"

Note: For deploying subgraph to index contracts on different networks
https://thegraph.com/docs/en/hosted-service/deploy-subgraph-hosted/#deploying-the-subgraph-to-multiple-ethereum-networks

